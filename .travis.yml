language: c

install:
  - source tools/ci/install.sh
  - export PYTHONUNBUFFERED=true

script:
  - export CC="gcc -std=c89"
  - source deactivate
  - conda install --yes conda-build
  - conda build tools/conda-recipe
  - source activate $python
  - conda install $HOME/miniconda/conda-bld/linux-64/openmm-dev-*
  - conda list -e
  - # run the python tests too
  - cd wrappers/python/tests
  - nosetests -vv --processes=-1 --process-timeout=200

env:
  matrix:
    - python=2.7  CONDA_PY=27
    #- python=3.3  CONDA_PY=33

  global:
    # encrypted BINSTAR_TOKEN for push of dev package to binstar
    - secure: "ClGfqug2783GRJQERxzlVtY2gLwaaVlviznEB3LQ1rJ7Z2c+rQsQZy2LqtqioAYG/SlBw8hurKZXAJ92hczzzRf98zkCzIP1EcxzHvPgpddoJAEZkwdHFfYFqjElviCu2r55WfU/J8hLGpaELeeR0rgYRpqmHjDqoEUCih5Dqf4="

after_success:
  - echo "after_success"
  - source tools/ci/after_sucess.sh


